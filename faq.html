<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FAQ | Ngolay</title>
  <link rel="stylesheet" href="all_categories.css">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; font-family:"Poppins",sans-serif; }
    body { background-color: #d9d9e3; color: #333; font-size:1.05rem; }

    /* Header Styles */
    .header { display:flex; justify-content:space-between; align-items:center; background-color:#656283; padding:10px 30px; color:white; position:relative; flex-wrap:wrap; }
    .logo img { width:80px; height:80px; border-radius:50%; object-fit:cover; }
    .nav { display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
    .nav a { color:white; text-decoration:none; margin:0 15px; font-weight:bold; transition:0.3s; white-space:nowrap; }
    .nav a:hover { color:#ddd; }
    .header-icons { display:flex; align-items:center; gap:15px; position:relative; flex-wrap:wrap; }

    /* Search and Dropdown Styles */
    .search-container { position:relative; }
    #search-bar { display:none; padding:8px 12px; border-radius:5px; border:1px solid #ccc; width:200px; background:white; color:#333; }
    #search-results { display:none; background:white; color:black; position:absolute; top:45px; right:0; max-height:300px; overflow-y:auto; width:250px; border-radius:5px; z-index:1000; padding:5px; box-shadow:0 2px 10px rgba(0,0,0,0.1); border:1px solid #ddd; }
    #search-results div { padding:10px; cursor:pointer; border-bottom:1px solid #eee; transition:background-color 0.2s; }
    #search-results div:hover { background-color:#f5f5f5; }
    #search-results div:last-child { border-bottom:none; }
    .account-dropdown { position:relative; }
    .dropdown-menu { display:none; position:absolute; top:35px; right:0; background:white; border:1px solid #ddd; border-radius:5px; z-index:1000; box-shadow:0 2px 10px rgba(0,0,0,0.1); min-width:150px; }
    .dropdown-menu a { display:block; padding:10px 15px; text-decoration:none; color:#656283; border-bottom:1px solid #eee; transition:background-color 0.2s; }
    .dropdown-menu a:hover { background-color:#f5f5f5; }
    .dropdown-menu a:last-child { border-bottom:none; }

    /* FAQ Section */
    .faq { background-color: #b8b7ca; padding:60px 80px; line-height:1.6; min-height:70vh; }
    .faq h2 { text-align:center; font-size:2em; margin-bottom:30px; color:#333; }
    .faq-item { margin-bottom:20px; background-color:#d9d9e3; padding:20px; border-radius:10px; box-shadow:0 4px 8px rgba(0,0,0,0.1); transition:0.3s ease; cursor:pointer; overflow:hidden; }
    .faq-item:hover { background-color:#e3e3ee; transform:translateY(-3px); }
    .faq-item h3 { font-size:1.2em; color:#333; display:flex; justify-content:space-between; align-items:center; }
    .faq-item h3 span { font-weight:bold; font-size:1.3em; transition:0.3s; }
    .faq-item p { max-height:0; overflow:hidden; transition:max-height 0.5s ease; color:#444; margin-top:10px; }
    .faq-item.active p { max-height:200px; }
    .faq-item.active h3 span { transform:rotate(45deg); }

    /* Footer - Responsive */
    .footer { background-color:#656283; color:white; padding:40px; display:flex; justify-content:space-between; align-items:flex-start; flex-wrap:wrap; gap:30px; }
    .footer-logo { flex-shrink:0; }
    .footer-logo img { width:70px; height:70px; border-radius:50%; object-fit:cover; }
    .footer-links { flex:1; display:flex; justify-content:center; gap:60px; flex-wrap:wrap; }
    .footer-section { min-width:150px; }
    .footer-section h3 { margin-bottom:10px; font-size:1.1em; }
    .footer-section a { display:block; color:white; text-decoration:none; margin:5px 0; font-size:1.05em; transition:color 0.3s; }
    .footer-section a:hover { color:#ddd; }
    .footer-bottom { width:100%; text-align:center; border-top:1px solid #555; margin-top:20px; padding-top:15px; color:#aaa; }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .faq { padding:50px 40px; }
      .footer-links { gap:40px; }
    }

    @media (max-width: 768px) {
      .header { flex-direction:column; gap:15px; padding:15px 20px; }
      .nav { order:2; width:100%; justify-content:center; }
      .header-icons { order:3; justify-content:center; }
      .faq { padding:40px 20px; }
      .footer { padding:30px 20px; flex-direction:column; align-items:center; text-align:center; gap:25px; }
      .footer-links { flex-direction:column; align-items:center; gap:30px; }
      .footer-section { text-align:center; }
    }

    @media (max-width: 480px) {
      .faq { padding:30px 15px; }
      .faq h2 { font-size:1.6em; }
      .footer { padding:25px 15px; }
      .footer-links { gap:25px; }
      .nav a { margin:0 8px; font-size:0.95em; }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="logo"><img src="logo.png" alt="Ngolay Logo"></div>
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="categories.html">Categories</a>
      <a href="cart.html">Cart</a>
      <a href="wishlist.html">Wishlist</a>
    </nav>
    <div class="header-icons">
      <div class="search-container">
        <i class="search-icon" id="search-toggle">üîç</i>
        <input type="text" id="search-bar" placeholder="Search products...">
        <div id="search-results"></div>
      </div>
      <div class="account-dropdown">
        <i class="account-icon" id="account-toggle">üë§</i>
        <div class="dropdown-menu" id="account-menu">
          <a href="account.html">Account</a>
          <a href="login.html">Log In</a>
          <a href="#" id="logout-btn">Log Out</a>
        </div>
      </div>
    </div>
  </header>

  <!-- FAQ Section -->
  <section class="faq">
    <h2>Frequently Asked Questions (FAQ)</h2>

    <div class="faq-item">
      <h3>1. What is Ngolay? <span>+</span></h3>
      <p>Ngolay is a college marketplace where students can buy, sell, or exchange items and services safely.</p>
    </div>

    <div class="faq-item">
      <h3>2. How do I buy or sell something? <span>+</span></h3>
      <p>If you want to sell, just post your item with details (price, photos, pickup place). If you want to buy, contact the seller directly and fix a time to meet and pay.</p>
    </div>

    <div class="faq-item">
      <h3>3. What items are not allowed? <span>+</span></h3>
      <p>Illegal, harmful, fake, or offensive items. We may remove posts that break the rules.</p>
    </div>

    <div class="faq-item">
      <h3>4. What if I get scammed? <span>+</span></h3>
      <p>Ngolay is not responsible for disputes, but you can report suspicious users to us.</p>
    </div>

    <div class="faq-item">
      <h3>5. Is my information safe? <span>+</span></h3>
      <p>Yes, we respect your privacy. Only share personal details if you are comfortable.</p>
    </div>

    <div class="faq-item">
      <h3>6. How do I contact Ngolay? <span>+</span></h3>
      <p>You can reach us at our <a href="contact.html" style="color:#656283; text-decoration:underline;">Contact Page</a> where you would be able to communicate with us.</p>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-logo"><img src="logo.png" alt="Ngolay Logo"></div>
    <div class="footer-links">
      <div class="footer-section">
        <h3>Company</h3>
        <a href="about.html">About Us</a>
        <a href="contact.html">Contact</a>
      </div>
      <div class="footer-section">
        <h3>Our Information</h3>
        <a href="terms.html">Terms and Conditions</a>
        <a href="faq.html">FAQ</a>
      </div>
    </div>
    <div class="footer-bottom"><p>¬© 2025 Ngolay. All Rights Reserved</p></div>
  </footer>

  <script type="module">
    // Firebase setup
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, getDocs, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCJfAyK_wma5RaTv6DODRgCDExnFuLXK00",
      authDomain: "ngolay-project.firebaseapp.com",
      projectId: "ngolay-project",
      storageBucket: "ngolay-project.appspot.com",
      messagingSenderId: "236457585222",
      appId: "1:236457585222:web:9133bb46a97ef678d23847"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let allProducts = [];
    let currentUserUid = null;

    // Load products for search functionality
    async function loadProductsForSearch() {
      try {
        const productsCol = collection(db, "products");
        const snapshot = await getDocs(productsCol);
        allProducts = snapshot.docs.map(docSnap => ({ 
          id: docSnap.id, 
          ...docSnap.data() 
        }));
      } catch (error) {
        console.error("Error loading products for search:", error);
      }
    }

    // Track page visit in Firestore
    async function trackPageVisit(pageName) {
      if (!currentUserUid) return;
      
      try {
        const visitRef = doc(db, "page_visits", `${currentUserUid}_${pageName}`);
        const visitSnap = await getDoc(visitRef);
        
        if (!visitSnap.exists()) {
          // First time visiting this page
          await setDoc(visitRef, {
            userId: currentUserUid,
            pageName: pageName,
            firstVisit: new Date(),
            lastVisit: new Date(),
            visitCount: 1
          });
          showWelcomeMessage(pageName);
        } else {
          // Update existing visit record
          const visitData = visitSnap.data();
          await setDoc(visitRef, {
            ...visitData,
            lastVisit: new Date(),
            visitCount: (visitData.visitCount || 0) + 1
          });
        }
      } catch (error) {
        console.error("Error tracking page visit:", error);
      }
    }

    // Show welcome message for first-time visitors
    function showWelcomeMessage(pageName) {
      const messages = {
        'terms': "Welcome to Ngolay's Terms and Conditions page!",
        'faq': "Welcome to Ngolay's FAQ section!"
      };
      
      if (messages[pageName]) {
        alert(messages[pageName]);
      }
    }

    // FAQ accordion toggle
    const faqItems = document.querySelectorAll('.faq-item');
    faqItems.forEach(item => {
      item.addEventListener('click', () => {
        faqItems.forEach(other => {
          if(other!==item){ 
            other.classList.remove('active'); 
            other.querySelector('span').textContent='+'; 
          }
        });
        item.classList.toggle('active');
        item.querySelector('span').textContent = item.classList.contains('active') ? '‚àí' : '+';
      });
    });

    // Header search & account dropdown
    const searchToggle = document.getElementById('search-toggle');
    const searchBar = document.getElementById('search-bar');
    const searchResults = document.getElementById('search-results');
    const accountToggle = document.getElementById('account-toggle');
    const accountMenu = document.getElementById('account-menu');

    // Search toggle
    searchToggle.addEventListener('click',() => { 
      searchBar.style.display = searchBar.style.display === 'block' ? 'none' : 'block';
      if(searchBar.style.display === 'block') searchBar.focus();
    });

    // Search functionality
    searchBar.addEventListener('input', () => {
      const queryText = searchBar.value.trim().toLowerCase();
      searchResults.innerHTML = '';
      
      if (!queryText) { 
        searchResults.style.display = 'none'; 
        return; 
      }

      const matched = allProducts.filter(p => 
        p.name && p.name.toLowerCase().includes(queryText) || 
        (p.category && p.category.toLowerCase().includes(queryText))
      );

      if (matched.length === 0) {
        searchResults.innerHTML = '<div>No products found.</div>';
      } else {
        matched.forEach(p => {
          const div = document.createElement('div');
          div.textContent = `${p.name} (${p.category})`;
          div.addEventListener('click', () => {
            window.location.href = `product_detail.html?id=${p.id}`;
          });
          searchResults.appendChild(div);
        });
      }
      
      searchResults.style.display = 'block';
    });

    // Close search results when clicking outside
    document.addEventListener('click', (e) => {
      if (!searchBar.contains(e.target) && !searchResults.contains(e.target) && e.target !== searchToggle) {
        searchResults.style.display = 'none';
      }
    });

    // Account dropdown
    accountToggle.addEventListener('click', e => {
      e.stopPropagation();
      accountMenu.style.display = accountMenu.style.display === 'block' ? 'none' : 'block';
    });
    
    document.addEventListener('click', e => {
      if(accountMenu.style.display === 'block' && !accountMenu.contains(e.target) && e.target !== accountToggle) {
        accountMenu.style.display = 'none';
      }
    });

    // Logout functionality
    const logoutBtn = document.getElementById('logout-btn');
    if (logoutBtn) {
      logoutBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        try {
          await signOut(auth);
          window.location.href = "login.html";
        } catch (error) {
          console.error("Error signing out:", error);
        }
      });
    }

    // Check authentication state
    onAuthStateChanged(auth, (user) => {
      if (user) {
        currentUserUid = user.uid;
        console.log("User is signed in:", user.uid);
        // Track page visit after authentication
        trackPageVisit('faq');
      } else {
        currentUserUid = null;
        console.log("User is signed out");
      }
    });

    // Load products on page load
    window.addEventListener('load', () => {
      loadProductsForSearch();
    });
  </script>
</body>
</html>

